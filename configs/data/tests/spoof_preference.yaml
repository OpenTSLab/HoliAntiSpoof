dataset:
  _target_: qwenvl.data.data_qwen.AudioSpoofingPreferenceDataset
  stage: training
  train_type: dpo
  model_type: qwen2.5omni
  dataset_list:
    - data/asvspoof2019/train_preference.json
  #   - data/partial_spoof/train.json
  processor:
    _target_: qwenvl.data.processing_qwen2_5_omni.Qwen2_5OmniProcessor.from_pretrained
    pretrained_model_name_or_path: /mnt/shared-storage-user/brainllm-share/checkpoints/Qwen2.5-Omni-7B
  data_format: "json"

collate_fn:
  _target_: qwenvl.data.data_qwen.OmniPreferenceCollator
  padding_config:
    chosen_input_ids: 151643
    chosen_labels: -100
    rejected_input_ids: 151643
    rejected_labels: -100
  torchify_keys:
    - video_second_per_grid
    - spoof_embeds